<t-navbar title="{{detail.name}}" left-arrow bind:click-left="onBack">
  <!-- 移除这里的收藏按钮 -->
</t-navbar>

<view class="fish-detail" wx:if="{{!loading}}">
  <!-- 鱼类图片 - 完全重构 -->
  <view class="fish-image-container">
    <image 
      class="fish-main-image"
      src="{{detail.images[currentImageIndex || 0]}}" 
      mode="aspectFit"
      bindtap="previewImage" 
      data-url="{{detail.images[currentImageIndex || 0]}}"
      binderror="imageLoadError"
      data-index="{{currentImageIndex || 0}}"
      lazy-load="{{false}}"
      show-menu-by-longpress
      webp="{{false}}" />
      
    <!-- 使用小圆点作为指示器 -->
    <view class="image-dots" wx:if="{{detail.images.length > 1}}">
      <view 
        class="dot {{currentImageIndex === index ? 'active' : ''}}" 
        wx:for="{{detail.images}}" 
        wx:key="index"
        bindtap="changeImage"
        data-index="{{index}}"></view>
    </view>
    
    <!-- 左右切换箭头 -->
    <view class="arrow left-arrow" bindtap="prevImage" wx:if="{{detail.images.length > 1}}">《</view>
    <view class="arrow right-arrow" bindtap="nextImage" wx:if="{{detail.images.length > 1}}">》</view>
  </view>

  <!-- 基本信息 -->
  <view class="info-section">
    <view class="info-header">
      <!-- 修改这里，添加新的包含标题和收藏按钮的布局 -->
      <view class="title-row">
      <view class="info-title">{{detail.name}}</view>
        <t-icon 
          class="favorite-icon"
          name="{{isFavorite ? 'heart-filled' : 'heart'}}" 
          size="48rpx" 
          color="{{isFavorite ? '#ff4c4c' : '#000000e6'}}" 
          bindtap="toggleFavorite"
        />
      </view>
    </view>

    <!-- 描述信息 -->
    <view class="description-section">
      <view class="section-title">鱼类描述</view>
      <block wx:if="{{detail.description && Array.isArray(detail.description) && detail.description.length > 0}}">
        <view class="description-list">
          <view class="description-item" wx:for="{{detail.description}}" wx:key="index">• {{item}}</view>
        </view>
      </block>
      <block wx:else>
        <view class="description-text">{{detail.description}}</view>
      </block>
    </view>

    <!-- 养护指南 -->
    <view class="care-guide-section">
      <view class="section-title">养护指南</view>
      
      <view class="parameter-grid">
        <view class="parameter-item">
          <view class="parameter-label">水温</view>
          <view class="parameter-value">{{detail.careGuide.waterParameters.temperature}}</view>
        </view>
        <view class="parameter-item">
          <view class="parameter-label">pH值</view>
          <view class="parameter-value">{{detail.careGuide.waterParameters.pH}}</view>
        </view>
        <view class="parameter-item">
          <view class="parameter-label">硬度</view>
          <view class="parameter-value">{{detail.careGuide.waterParameters.hardness}}</view>
        </view>
      </view>
      
      <view class="info-item">
        <view class="info-label">建议缸体</view>
        <view class="info-value">{{detail.careGuide.tankSize}}</view>
      </view>
      
      <view class="info-item">
        <view class="info-label">饮食</view>
        <view class="info-value diet-list">
          <text wx:for="{{detail.careGuide.diet}}" wx:key="index" class="diet-item">{{item}}</text>
        </view>
      </view>
      
      <!-- 常见疾病 -->
      <view class="disease-section" wx:if="{{detail.careGuide.commonDiseases.length > 0}}">
        <view class="section-subtitle">常见疾病</view>
        <view class="disease-list">
          <view class="disease-item" wx:for="{{detail.careGuide.commonDiseases}}" wx:key="index">
            <view class="disease-name">{{item.name}}</view>
            <view class="disease-info">
              <text class="disease-label">症状：</text>
              <text>{{item.symptoms}}</text>
            </view>
            <view class="disease-info">
              <text class="disease-label">预防：</text>
              <text>{{item.prevention}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 繁殖信息 -->
    <view class="breeding-section">
      <view class="section-title">繁殖信息</view>
      <view class="breeding-grid">
        <view class="breeding-item">
          <view class="breeding-label">难度</view>
          <view class="breeding-value">{{detail.breedingInfo.difficulty}}</view>
        </view>
        <view class="breeding-item">
          <view class="breeding-label">产卵温度</view>
          <view class="breeding-value">{{detail.breedingInfo.spawningTemp}}</view>
        </view>
        <view class="breeding-item">
          <view class="breeding-label">孵化时间</view>
          <view class="breeding-value">{{detail.breedingInfo.eggHatchTime}}</view>
        </view>
      </view>
      <view class="info-item" wx:if="{{detail.breedingInfo.specialRequirements}}">
        <view class="info-label">特殊要求</view>
        <view class="info-value">{{detail.breedingInfo.specialRequirements}}</view>
      </view>
    </view>
  </view>
</view>

<view class="loading-container" wx:else>
  <t-loading theme="circular" size="40rpx" text="加载中..." />
</view> 